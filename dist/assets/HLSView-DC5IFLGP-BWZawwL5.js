import{i as y,F as d,T as w,s as ke,_ as ot,a as L,u as st,m as ye,b as Ft,V as it,A as Z,E as Ot,g as Vt,v as ct,c as jt,d as zt,e as Zt,f as Nt,h as Se,S as q,j as re,k as oe,l as me,n as Wt,o as ve,p as Ut,q as v,K as be,r as H,t as B,w as F,x as Gt,B as j,L as Ke,W as Qe,y as Kt,z as Qt,C as Yt,D as Ye,I as J,G as X,H as qt,J as dt,M as Jt,N as Xt,O as en,P as tn,Q as qe,R as ut,U as nn,X as an,Y as le,Z as Je,$ as ue,a0 as K,a1 as ln,a2 as rn,a3 as on,a4 as sn,a5 as cn,a6 as dn,a7 as un,a8 as mn,a9 as Xe,aa as fn,ab as pn,ac as hn,ad as mt,ae as En}from"./MeetingPage-BEPXIxnI.js";import{r as n,R as e}from"./index-DbbjP9G_.js";import"./index-BBKudAMd.js";import"./regexp-get-flags-CAhsIPw6.js";var _e=t=>n.createElement("svg",Object.assign({width:"24px",height:"24px",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.792 12.916a.116.116 0 1 1 0 .232.116.116 0 0 1 0-.232Zm1.366.116a1.366 1.366 0 1 0-2.732 0 1.366 1.366 0 0 0 2.732 0ZM3.125 5a.625.625 0 0 0-.625.625v4.444c0 .346.28.625.625.625h4.444a.625.625 0 1 0 0-1.25H3.75V5.625A.625.625 0 0 0 3.125 5Z",fill:"currentColor"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.792 6.99a6.041 6.041 0 0 1 6.042 6.042.625.625 0 1 0 1.25 0 7.291 7.291 0 0 0-7.292-7.291A7.292 7.292 0 0 0 4.93 7.604l-2.223 2a.625.625 0 1 0 .836.93l2.222-2a6.042 6.042 0 0 1 4.027-1.543Z",fill:"currentColor"})),gn=t=>n.createElement("svg",Object.assign({width:"24px",height:"24px",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),n.createElement("g",{clipPath:"url(#ColoredHandIcon_svg__a)"},n.createElement("path",{d:"M5.747 10.359c.004-.004.01-.005.014-.008v-.002l-.014.01Z",fill:"url(#ColoredHandIcon_svg__b)"}),n.createElement("path",{d:"M9.005 8.58c-.953-.954-1.977-.793-2.766-.004L5.106 23.108c0 .137.013.273.02.41l8.152-8.151c-3.411.89-2.409-1.958-3.592-2.694 0 0 1.307-2.105-.68-4.094Z",fill:"url(#ColoredHandIcon_svg__c)"}),n.createElement("path",{d:"M34.57 17.645a1.666 1.666 0 0 0-2.357 0l-4.818 4.818-.535-.643 8.005-8.005a2.083 2.083 0 1 0-2.946-2.946l-7.74 7.738-.535-.643L31.92 9.69a2.083 2.083 0 1 0-2.947-2.946l-8.008 8.008-.536-.643 6.103-6.102c.77-.771.918-2.027.229-2.871a2.083 2.083 0 0 0-3.091-.16L5.126 23.519a6.663 6.663 0 0 0 1.934 4.328l6.297 6.297a5 5 0 0 0 7.071 0L34.57 20.002a1.666 1.666 0 0 0 0-2.357Z",fill:"url(#ColoredHandIcon_svg__d)"}),n.createElement("path",{d:"M24.258 7.333a1.25 1.25 0 1 0 1.768-1.768 1.25 1.25 0 0 0-1.768 1.768ZM29.561 9.1a1.25 1.25 0 1 0 1.768-1.767A1.25 1.25 0 0 0 29.561 9.1ZM32.508 13.226a1.25 1.25 0 1 0 1.767-1.768 1.25 1.25 0 0 0-1.767 1.768ZM32.802 19.413a.833.833 0 1 0 1.179-1.179.833.833 0 0 0-1.179 1.179Z",fill:"#FFF0C9"})),n.createElement("defs",null,n.createElement("linearGradient",{id:"ColoredHandIcon_svg__b",x1:5.742,y1:10.376,x2:5.743,y2:10.377,gradientUnits:"userSpaceOnUse"},n.createElement("stop",{stopColor:"#FFC430"}),n.createElement("stop",{offset:.57,stopColor:"#F8BD29"}),n.createElement("stop",{offset:1,stopColor:"#F0B421"})),n.createElement("linearGradient",{id:"ColoredHandIcon_svg__c",x1:5.602,y1:15.715,x2:14.901,y2:15.78,gradientUnits:"userSpaceOnUse"},n.createElement("stop",{offset:.282,stopColor:"#FFC430"}),n.createElement("stop",{offset:.401,stopColor:"#F8BD2D"}),n.createElement("stop",{offset:.574,stopColor:"#E5AA23"}),n.createElement("stop",{offset:.78,stopColor:"#C58A14"}),n.createElement("stop",{offset:1,stopColor:"#9C6000"})),n.createElement("linearGradient",{id:"ColoredHandIcon_svg__d",x1:20.364,y1:14.599,x2:19.817,y2:43.562,gradientUnits:"userSpaceOnUse"},n.createElement("stop",{stopColor:"#FFC430"}),n.createElement("stop",{offset:.41,stopColor:"#FEC130"}),n.createElement("stop",{offset:.72,stopColor:"#FCB730"}),n.createElement("stop",{offset:.998,stopColor:"#F7A72F"}),n.createElement("stop",{offset:1,stopColor:"#F7A72F"})),n.createElement("clipPath",{id:"ColoredHandIcon_svg__a"},n.createElement("path",{fill:"currentColor",d:"M0 0h40v40H0z"})))),Ce=t=>n.createElement("svg",Object.assign({width:"24px",height:"24px",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.792 12.916a.116.116 0 1 0 0 .232.116.116 0 0 0 0-.232Zm-1.366.116a1.366 1.366 0 1 1 2.731 0 1.366 1.366 0 0 1-2.731 0ZM16.458 5c.346 0 .625.28.625.625v4.444c0 .346-.28.625-.625.625h-4.444a.625.625 0 1 1 0-1.25h3.82V5.625c0-.345.28-.625.624-.625Z",fill:"currentColor"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.791 6.99a6.042 6.042 0 0 0-6.041 6.042.625.625 0 1 1-1.25 0 7.292 7.292 0 0 1 7.292-7.291 7.292 7.292 0 0 1 4.861 1.863h.001l2.222 2a.625.625 0 1 1-.836.93l-2.221-2A6.042 6.042 0 0 0 9.79 6.991Z",fill:"currentColor"})),vn=t=>n.createElement("svg",Object.assign({width:"24px",height:"24px",viewBox:"0 0 49 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),n.createElement("path",{d:"M27.509 10h6.008v28.04H27.51V10ZM14.5 10h6.009v28.04H14.5V10Z",fill:"currentColor"})),$n=t=>n.createElement("svg",Object.assign({width:"24px",height:"24px",viewBox:"0 0 49 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),n.createElement("path",{d:"M34.34 21.217 19.913 10.67a3.53 3.53 0 0 0-1.693-.647 3.677 3.677 0 0 0-1.82.258 3.223 3.223 0 0 0-1.382 1.084 2.718 2.718 0 0 0-.518 1.574v22.164c.002.557.182 1.102.518 1.573.337.47.816.845 1.382 1.083a3.678 3.678 0 0 0 1.818.259 3.53 3.53 0 0 0 1.693-.646l14.43-10.547c.464-.34.838-.767 1.096-1.25.257-.484.39-1.013.39-1.548 0-.535-.133-1.064-.39-1.548a3.714 3.714 0 0 0-1.097-1.25v-.012Z",fill:"currentColor"})),ft=t=>n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"24px",height:"24px",viewBox:"0 0 20 20",fill:"none"},t),n.createElement("path",{d:"M14.784 5.192a.654.654 0 0 0-.926.925 5.888 5.888 0 0 1 0 8.325.654.654 0 1 0 .926.925 7.196 7.196 0 0 0 0-10.175Z",fill:"currentColor"}),n.createElement("path",{d:"M12.474 7.5a.654.654 0 1 0-.925.926 2.617 2.617 0 0 1 0 3.7.654.654 0 1 0 .925.925 3.925 3.925 0 0 0 0-5.55Z",fill:"currentColor"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.696 5.7a.654.654 0 0 0-1.063-.51L5.541 7.661H3.154a.654.654 0 0 0-.654.655v3.925c0 .36.293.654.654.654h2.387l3.092 2.473a.654.654 0 0 0 1.063-.51v-9.16ZM6.18 8.827l2.208-1.766v6.436L6.18 11.731a.654.654 0 0 0-.41-.143H3.809V8.97h1.963c.148 0 .293-.05.409-.144Z",fill:"currentColor"})),wn=t=>n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"24px",height:"24px",viewBox:"0 0 40 40",fill:"none"},t),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.77 10.13c.457.22.748.682.748 1.19v18.477a1.32 1.32 0 0 1-2.145 1.03l-6.237-4.99H6.32A1.32 1.32 0 0 1 5 24.517V16.6c0-.729.59-1.32 1.32-1.32h4.816l6.237-4.99a1.32 1.32 0 0 1 1.397-.159Zm-1.892 3.936-4.455 3.563a1.32 1.32 0 0 1-.824.29h-3.96v5.279h3.96c.3 0 .59.102.824.29l4.455 3.563V14.066Z",fill:"currentColor"}),n.createElement("path",{d:"M34.969 15.666a1.32 1.32 0 0 1 0 1.866l-3.027 3.026 3.027 3.026a1.32 1.32 0 0 1-1.867 1.867l-3.026-3.026-3.026 3.026a1.32 1.32 0 0 1-1.867-1.867l3.027-3.026-3.027-3.026a1.32 1.32 0 1 1 1.867-1.866l3.026 3.026 3.026-3.026a1.32 1.32 0 0 1 1.867 0Z",fill:"currentColor"})),yn=function(t,a){return typeof a=="boolean"?a:!t},bn=function(t){return n.useReducer(yn,t)};y();y();function _n({hlsStatsState:t,onClose:a}){var l,s,r;return e.createElement(d,{css:{position:"absolute",width:"$80",marginLeft:"$8",padding:"$8 $8 $10",zIndex:10,backgroundColor:"$surface_brighter",borderRadius:"$1"},direction:"column"},e.createElement(qt,{css:{position:"absolute",top:"$2",right:"$2"},onClick:a},e.createElement(dt,null)),e.createElement(z,{label:"URL"},e.createElement(d,{align:"center"},e.createElement("a",{style:{cursor:"pointer",textDecoration:"underline"},href:t==null?void 0:t.url,target:"_blank",rel:"noreferrer"},"Stream url"))),e.createElement(z,{label:"Video size"},` ${(l=t==null?void 0:t.videoSize)==null?void 0:l.width}x${(s=t==null?void 0:t.videoSize)==null?void 0:s.height}`),e.createElement(z,{label:"Buffer duration"},(r=t==null?void 0:t.bufferedDuration)==null?void 0:r.toFixed(2)," "),e.createElement(z,{label:"Connection speed"},`${((t==null?void 0:t.bandwidthEstimate)/(1e3*1e3)).toFixed(2)} Mbps`),e.createElement(z,{label:"Bitrate"},`${((t==null?void 0:t.bitrate)/(1e3*1e3)).toFixed(2)} Mbps`),e.createElement(z,{label:"distance from live"},Cn(t.distanceFromLive/1e3)),e.createElement(z,{label:"Dropped frames"},t==null?void 0:t.droppedFrames))}function Cn(t){let a=Math.floor(t);const l=Math.floor(a/3600);a=a-l*3600;const s=Math.floor(a/60),r=Math.floor(a-s*60),c=`${s<10?"0"+s:s}`,f=`${r<10?"0"+r:r}`;let u=`${c}:${f}`;return l&&(u=`${`${l<10?"0"+l:l}`}:${c}:${f}`),u}var z=n.memo(({label:t,children:a})=>e.createElement(d,{gap:4,justify:"center",css:{width:"100%"}},e.createElement(w,{css:{width:"50%","@md":{fontSize:"$md"},"@sm":{fontSize:"$sm"}}},t),e.createElement(w,{css:{"@md":{fontSize:"$md"},"@sm":{fontSize:"$sm"},width:"50%",overflowWrap:"break-word"}},a)));y();y();var xn=ke(d,{justifyContent:"center",alignItems:"center",alignSelf:"stretch",width:"100%",gap:"$2"}),kn=ke(d,{justifyContent:"flex-start",alignItems:"center",width:"100%",gap:"$4"}),Sn=ke(d,{justifyContent:"flex-end",alignItems:"center",width:"100%",gap:"$4"});y();var Pn=n.forwardRef((t,a)=>{var l=t,{children:s}=l,r=ot(l,["children"]);return e.createElement(d,L({"data-testid":"hms-video",css:{size:"100%",position:"relative",justifyContent:"center",transition:"all 0.3s ease-in-out","@md":{height:"auto","& video":{height:"$60 !important"}},"& video::cue":{color:"#EFF0FA",whiteSpace:"pre-line",fontSize:"$sm",fontStyle:"normal",fontWeight:"$regular",lineHeight:"$sm",letterSpacing:"0.25px"},"& video::-webkit-media-text-track-display":{padding:"0 $4",boxShadow:"0px 1px 3px 0px #000000A3"},"& video::-webkit-media-text-track-container":{fontSize:"$space$10 !important"}},direction:"column"},r),e.createElement("video",{style:{margin:"0 auto",objectFit:"contain",width:"auto",height:"100%",maxWidth:"100%"},ref:a,playsInline:!0,disablePictureInPicture:!0}),s)});y();y();y();var pt=e.createContext({hlsPlayer:void 0}),se=()=>n.useContext(pt),xe=({isPaused:t,width:a=20,height:l=20})=>{const{hlsPlayer:s}=se(),r=c=>F(void 0,null,function*(){c==null||c.stopPropagation(),t?yield s==null?void 0:s.play():s==null||s.pause()});return e.createElement(X,{title:t?"Play":"Pause",side:"top"},e.createElement(J,{onClick:r,"data-testid":"play_pause_btn"},t?e.createElement($n,{width:a,height:l}):e.createElement(vn,{width:a,height:l})))};y();var Y=({title:t,onClick:a,children:l,css:s})=>e.createElement(X,{title:t,side:"top"},e.createElement(J,{onClick:a,"data-testid":"backward_forward_arrow_btn",css:s},l)),Tn=({isPaused:t,onSeekTo:a})=>e.createElement(e.Fragment,null,e.createElement(Y,{onClick:l=>{l.stopPropagation(),a(-10)},title:"backward"},e.createElement(_e,{width:20,height:20})),e.createElement(xe,{isPaused:t}),e.createElement(Y,{onClick:l=>{l.stopPropagation(),a(10)},title:"forward"},e.createElement(Ce,{width:20,height:20}))),Ln=({isPaused:t,showControls:a,hoverControlsVisible:l})=>{const s=re(oe.media.md),r=me();return!s&&!r?e.createElement(e.Fragment,null,e.createElement(d,{css:{bg:"rgba(0, 0, 0, 0.6)",r:"$round",size:"$24",visibility:l.seekBackward?"":"hidden",opacity:l.seekBackward?"1":"0"},direction:"column",align:"center"},e.createElement(Y,{title:"backward"},e.createElement(_e,{width:52,height:52})),e.createElement(w,{variant:"body2",css:{fontWeight:"$regular"}},"10 secs")),e.createElement(j,{css:{bg:"rgba(0, 0, 0, 0.6)",r:"$round",visibility:l.pausePlay?"":"hidden",opacity:l.pausePlay?"1":"0"}},e.createElement(xe,{isPaused:t,width:48,height:48})),e.createElement(d,{css:{bg:"rgba(0, 0, 0, 0.6)",r:"$round",size:"$24",visibility:l.seekForward?"":"hidden",opacity:l.seekForward?"1":"0"},direction:"column",align:"center"},e.createElement(Y,{title:"forward"},e.createElement(Ce,{width:52,height:52})),e.createElement(w,{variant:"body2",css:{fontWeight:"$regular"}},"10 secs"))):e.createElement(d,{align:"center",justify:"center",css:{position:"absolute",bg:"#00000066",display:"inline-flex",gap:"$2",zIndex:1,size:"100%",visibility:a?"":"hidden",opacity:a?"1":"0"}},e.createElement(Y,{title:"backward",css:{visibility:l.seekBackward?"":"hidden",opacity:l.seekBackward?"1":"0"}},e.createElement(_e,{width:32,height:32})),e.createElement(j,{css:{bg:"rgba(0, 0, 0, 0.6)",r:"$round"}},e.createElement(xe,{isPaused:t,width:48,height:48})),e.createElement(Y,{title:"forward",css:{visibility:l.seekForward?"":"hidden",opacity:l.seekForward?"1":"0"}},e.createElement(Ce,{width:32,height:32})))};y();y();function $e(t,a){return t/a*100}function we(t){let a=Math.floor(t);const l=Math.floor(a/3600);a=a-l*3600;const s=Math.floor(a/60),r=Math.floor(a-s*60),c=`${s<10?`0${s}`:s}`,f=`${r<10?`0${r}`:r}`;let u=`${c}:${f}`;return l&&(u=`${`${l<10?`0${l}`:l}`}:${c}:${f}`),u}function ht(t){return isFinite(t.duration)?t.duration:t.seekable.length>0?t.seekable.end(0):0}var Mn=({seekProgress:t,setSeekProgress:a})=>{const{hlsPlayer:l}=se(),[s,r]=n.useState(0),[c,f]=n.useState(0),u=l==null?void 0:l.getVideoElement(),$=n.useCallback(()=>{var P;if(!u)return;const x=ht(u),M=Math.floor($e(u.currentTime,x));let k=0;u.buffered.length>0&&(k=Math.floor($e((P=u.buffered)==null?void 0:P.end(0),x))),isNaN(M)||r(M),isNaN(k)||f(k)},[u]),h=n.useCallback(()=>{!u||t||$()},[t,$,u]);n.useEffect(()=>{if(u)return $(),u.addEventListener("timeupdate",h),function(){u==null||u.removeEventListener("timeupdate",h)}},[$,h,u]);const p=P=>{var x;const M=Math.floor($e(P[0],100)),k=l==null?void 0:l.getVideoElement();if(!k)return;const N=isFinite(k.duration)?k.duration:((x=k.seekable)==null?void 0:x.end(0))||0,ie=M*N/100;l==null||l.seekTo(ie),$()};return u?e.createElement(d,{align:"center",css:{cursor:"pointer",h:"$2",alignSelf:"stretch"}},e.createElement(mt,{id:"video-actual-rest",css:{cursor:"pointer",h:"$2",zIndex:1,transition:"all .2s ease .5s"},min:0,max:100,step:1,value:[s],showTooltip:!1,onValueChange:p,onPointerDown:()=>a(!0),onPointerUp:()=>a(!1),thumbStyles:{w:"$6",h:"$6"}}),e.createElement(j,{id:"video-buffer",css:{h:"$2",width:`${c-s}%`,background:"$on_surface_high",position:"absolute",left:`${s}%`,opacity:"25%"}})):null};y();var An=()=>{const{hlsPlayer:t}=se(),[a,l]=n.useState(we(0)),s=n.useCallback(r=>{const c=t==null?void 0:t.getVideoElement();if(c){const f=ht(c);l(we(f-r))}else l(we(r))},[t]);return n.useEffect(()=>{const r=c=>{s(c)};if(t){t.on(v.CURRENT_TIME,r);const c=t==null?void 0:t.getVideoElement();s(c.currentTime)}return function(){t==null||t.off(v.CURRENT_TIME,r)}},[t,s]),t?e.createElement(w,{variant:"body1",css:{minWidth:"$16",c:"$on_surface_medium",display:"flex",justifyContent:"center",fontWeight:"$regular"}},"-",a):null};y();var Dn=()=>{var t;const{hlsPlayer:a}=se(),[l,s]=n.useState((t=a==null?void 0:a.volume)!=null?t:100),[r,c]=n.useState(!1);return e.createElement(d,{align:"center",css:{color:"$on_surface_high"},onMouseOver:f=>{f.stopPropagation(),c(!0)},onMouseLeave:f=>{f.stopPropagation(),c(!1)}},e.createElement(Rn,{volume:l,onClick:()=>{l>0?(s(0),a==null||a.setVolume(0)):(s(100),a==null||a.setVolume(100))}}),e.createElement(mt,{css:{mx:"$4",w:"$20",cursor:"pointer","@sm":{w:"$14"},"@xs":{w:"$14"},opacity:r?"1":"0",display:r?"":"none",transition:"all .2s ease .5s"},min:0,max:100,step:1,value:[l],onValueChange:f=>{a==null||a.setVolume(f[0]),s(f[0])},thumbStyles:{w:"$6",h:"$6"}}))},Rn=({volume:t,onClick:a})=>t===0?e.createElement(wn,{style:{cursor:"pointer",transition:"color 0.3s"},onClick:a}):t<50?e.createElement(En,{style:{cursor:"pointer",transition:"color 0.3s"},onClick:a}):e.createElement(ft,{style:{cursor:"pointer",transition:"color 0.3s"},onClick:a}),C={Root:Pn,Progress:Mn,Duration:An,Volume:Dn,Controls:{Root:xn,Left:kn,Right:Sn},PlayPauseSeekControls:{Overlay:Ln,Button:Tn}};y();var In=({isFullScreen:t,onToggle:a})=>e.createElement(X,{title:`${t?"Exit":"Go"} fullscreen`,side:"top"},e.createElement(J,{css:{margin:"0px"},onClick:a,key:"fullscreen_btn","data-testid":"fullscreen_btn"},e.createElement(d,null,t?e.createElement(Jt,null):e.createElement(Xt,null))));y();function et({open:t,unblockAutoPlay:a}){const l=me();return(re(oe.media.md)||l)&&t?e.createElement(J,{css:{border:"1px solid white",bg:"white",color:"#000",r:"$2"},onClick:()=>F(this,null,function*(){return yield a()})},e.createElement(ft,{width:"32",height:"32"}),e.createElement(w,{variant:"body1",css:{fontWeight:"$semiBold",px:"$2",color:"#000"}},"Tap To Unmute")):e.createElement(en.Root,{open:t,onOpenChange:r=>F(this,null,function*(){r||(yield a())})},e.createElement(tn,{title:"Attention",closeable:!1},e.createElement(qe,null,e.createElement(w,{variant:"md"},'The browser wants us to get a confirmation for playing the HLS Stream. Please click "play stream" to proceed.')),e.createElement(qe,{justify:"end"},e.createElement(ut,{variant:"primary",onClick:()=>F(this,null,function*(){yield a()})},"Play stream"))))}y();function tt({isEnabled:t}){const{hlsPlayer:a}=se();return e.createElement(X,{title:"Subtitles/closed captions",side:"top"},e.createElement(J,{css:{p:"$2"},onClick:()=>a==null?void 0:a.toggleCaption()},t?e.createElement(nn,{width:"20",height:"20px"}):e.createElement(an,{width:"20",height:"20px"})))}y();function nt({open:t,onOpenChange:a,layers:l,onQualityChange:s,selection:r,isAuto:c,containerRef:f}){const u=re(oe.media.md),$=me();return l.length===0?null:u||$?e.createElement(le.Root,{open:t,onOpenChange:a},e.createElement(le.Trigger,{asChild:!0,"data-testid":"quality_selector"},e.createElement(d,{css:{color:"$on_primary_high",r:"$1",cursor:"pointer",p:"$2"}},e.createElement(Je,null))),e.createElement(le.Content,{container:f,css:{bg:"$surface_default",pb:"$1"},onClick:()=>a(!1)},e.createElement(le.Title,{css:{display:"flex",color:"$on_surface_high",w:"100%",justifyContent:"space-between",mt:"$8",fontSize:"$md",px:"$10",pb:"$8",borderBottom:"1px solid $border_bright",alignItems:"center"}},"Quality",e.createElement(le.Close,{css:{color:"$on_surface_high"},onClick:()=>a(!1)},e.createElement(dt,null))),l.map(h=>e.createElement(d,{align:"center",css:{w:"100%",bg:"$surface_default","&:hover":{bg:"$surface_brighter"},cursor:"pointer",gap:"$4",py:"$8",px:"$10"},key:h.width,onClick:()=>s(h)},e.createElement(w,{variant:"caption",css:{fontWeight:"$semiBold"}},at(h)),e.createElement(w,{variant:"caption",css:{flex:"1 1 0",c:"$on_surface_low",pl:"$2"}},lt(h)),!c&&h.width===(r==null?void 0:r.width)&&h.height===(r==null?void 0:r.height)&&e.createElement(ue,{width:"16px",height:"16px"}))),e.createElement(d,{align:"center",css:{w:"100%",bg:"$surface_default","&:hover":{bg:"$surface_brighter"},cursor:"pointer",gap:"$4",py:"$8",px:"$10"},key:"auto",onClick:()=>s({height:"auto"})},e.createElement(w,{variant:"caption",css:{fontWeight:"$semiBold",flex:"1 1 0"}},"Auto"),c&&e.createElement(ue,{width:"16px",height:"16px"})))):e.createElement(K.Root,{open:t,onOpenChange:h=>a(h),modal:!1},e.createElement(K.Trigger,{asChild:!0,"data-testid":"quality_selector"},e.createElement(d,{css:{color:"$on_primary_high",r:"$1",cursor:"pointer",p:"$2"}},e.createElement(X,{title:"Select Quality",side:"top"},e.createElement(d,{align:"center"},e.createElement(j,{css:{w:"$9",h:"$9",display:"inline-flex",alignItems:"center",c:"$on_surface_high"}},e.createElement(Je,null)),e.createElement(w,{variant:{"@md":"sm","@sm":"xs","@xs":"tiny"},css:{display:"flex",alignItems:"center",ml:"$2",c:"$on_surface_medium"}},c&&e.createElement(e.Fragment,null,"Auto",e.createElement(j,{css:{mx:"$2",w:"$2",h:"$2",background:"$on_surface_medium",r:"$1"}})),r&&Math.min(r.width||0,r.height||0),"p"))))),e.createElement(K.Portal,{container:f},e.createElement(K.Content,{sideOffset:5,align:"end",css:{height:"auto",maxHeight:"$52",w:"$40",bg:"$surface_bright",py:"$4",gap:"$4",display:"grid"}},l.map(h=>e.createElement(K.Item,{onClick:()=>s(h),key:h.width,css:{bg:!c&&h.width===(r==null?void 0:r.width)&&h.height===(r==null?void 0:r.height)?"$surface_default":"$surface_bright","&:hover":{bg:"$surface_brighter"},p:"$2 $4 $2 $8",h:"$12",gap:"$2"}},e.createElement(w,{variant:"caption",css:{fontWeight:"$semiBold"}},at(h)),e.createElement(w,{variant:"caption",css:{flex:"1 1 0",c:"$on_surface_low",pl:"$2"}},lt(h)),!c&&h.width===(r==null?void 0:r.width)&&h.height===(r==null?void 0:r.height)&&e.createElement(ue,{width:"16px",height:"16px"}))),e.createElement(K.Item,{onClick:()=>s({height:"auto"}),key:"auto",css:{bg:c?"$surface_default":"$surface_bright","&:hover":{bg:"$surface_brighter"},p:"$2 $4 $2 $8",h:"$12",gap:"$2"}},e.createElement(w,{variant:"caption",css:{fontWeight:"$semiBold",flex:"1 1 0"}},"Auto"),c&&e.createElement(ue,{width:"16px",height:"16px"})))))}var at=t=>`${Math.min(t.height||0,t.width||0)}p `,lt=t=>`(${(Number(t.bitrate/1e3)/1e3).toFixed(2)} Mbps)`;y();var Hn=()=>{const{title:t,details:a,description:l}=ln(),s=Se(q.ROOM_DETAILS);return rn(q.ROOM_DETAILS)?e.createElement(d,{gap:"4",align:"center",justify:"between",css:{position:"relative",h:"fit-content",w:"100%",borderBottom:"1px solid $border_bright",p:"$8",backgroundColor:"$surface_dim"}},e.createElement(w,{variant:"sub2",css:{fontWeight:"$semiBold"}},"About Session"),e.createElement(d,{onClick:s,css:{color:"$on_surface_high",cursor:"pointer","&:hover":{opacity:"0.8"}}},e.createElement(on,null))):e.createElement(d,{gap:"4",align:"center",css:{position:"relative",h:"fit-content",w:"100%",borderBottom:"1px solid $border_bright",p:"$8",backgroundColor:"$surface_dim"}},e.createElement(sn,null),e.createElement(d,{direction:"column"},t?e.createElement(w,{variant:"sub2",css:{fontWeight:"$semiBold"}},t):null,e.createElement(d,null,e.createElement(cn,{details:a}),l?e.createElement(w,{variant:"caption",css:{color:"$on_surface_medium"},onClick:s}," ...more"):null)))},i,Q={},rt=({isFullScreen:t=!1})=>{const{elements:a}=st(),l=ye(it(Z.sidePane)),s=Se(q.CHAT),r=!!(a!=null&&a.chat),c=re(oe.media.md),f=ct();return n.useEffect(()=>{be({sidepane:l,isMobile:c,showChat:r,isFullScreen:t}).with({isFullScreen:!0},()=>{f.setAppData(Z.sidePane,"")}).with({isMobile:!0,showChat:!0,sidepane:dn.when(u=>!u)},()=>{s()}).with({showChat:!1,isMobile:!0,sidepane:q.CHAT},()=>{f.setAppData(Z.sidePane,"")}).otherwise(()=>{})},[l,c,s,r,f,t]),null},Bn=()=>{var t,a,l,s,r,c,f;const u=n.useRef(null),$=n.useRef(),{elements:h}=st(),p=ye(Ft),P=ye(it(Z.hlsStats)),x=Ot(Vt.POLL_STOPPED),M=ct(),{themeType:k}=jt(),[N,ie]=n.useState(!1);let[fe,Et]=n.useState(null);const O=(t=p.variants[0])==null?void 0:t.url,[ee,gt]=n.useState([]),[W,Pe]=n.useState(!0),[Te,vt]=n.useState(!0),[Le,$t]=n.useState(!1),[Me,wt]=n.useState(null),[ce,Ae]=n.useState(!1),[b,A]=n.useState({seekForward:!1,pausePlay:!1,seekBackward:!1}),[U,yt]=n.useState(!1),[bt,pe]=bn(!1),De=zt(O),he=Zt(),[D,te]=n.useState(!0),[Re,_t]=n.useState(!0),[G,Ie]=n.useState(!1),He=n.useRef(null),S=n.useRef(),[ne,Ct]=n.useState(!1),xt=Nt.isEnabled,kt=Se(q.CHAT),St=!!(h!=null&&h.chat),E=re(oe.media.md),g=me(),R=Wt($,bt,{onClose:()=>pe(!1)}),[Ee,Be]=n.useState(!1);n.useEffect(()=>{const o=u.current,m=()=>Be(!0),V=()=>Be(!1);return o==null||o.addEventListener("playing",V),o==null||o.addEventListener("waiting",m),()=>{o==null||o.removeEventListener("playing",V),o==null||o.removeEventListener("waiting",m)}},[]),n.useEffect(()=>{N&&De!==O&&ie(!1)},[O,N,De]),n.useEffect(()=>{if(!x)return;(Q==null?void 0:Q[x.data.id])&&(ve.removeToast(Q[x.data.id]),delete Q[x.data.id])},[x]),n.useEffect(()=>{const o=u.current,m=()=>{ie(!0),o==null||o.removeEventListener("ended",m)};return o==null||o.addEventListener("ended",m),()=>{o==null||o.removeEventListener("ended",m)}},[O]);const Fe=n.useCallback(o=>{var m;i&&(_t(((m=o.height)==null?void 0:m.toString().toLowerCase())==="auto"),i==null||i.setLayer(o))},[ee]);n.useEffect(()=>{let o=u.current;const m=({layers:_})=>{gt(_),$t(i==null?void 0:i.hasCaptions())},V=({layer:_})=>{wt(_)},Ve=_=>{var Ue=_,{payload:At}=Ue,Dt=ot(Ue,["payload"]),Ge;const Rt=T=>{try{return JSON.parse(T)}catch{return T}},It=Dt.duration,I=Rt(At);if(I.startsWith("poll:")){const T=I.substr(I.indexOf(":")+1),ae=he.getState(un(T)),Ht=he.getState(mn(ae.startedBy))||"Participant";if(!Q[T]){const Bt=ve.addToast({title:`${Ht} started a ${ae.type}: ${ae.title}`,action:e.createElement(ut,{onClick:()=>{M.setAppData(Z.pollState,{[Xe.pollInView]:T,[Xe.view]:fn.VOTE}),M.setAppData(Z.sidePane,q.POLLS)},variant:"standard",css:{backgroundColor:"$surface_bright",fontWeight:"$semiBold",color:"$on_surface_high",p:"$xs $md"}},ae.type==="quiz"?"Answer":"Vote"),duration:1/0});Q[T]=Bt}return}switch(I.type){case pn:(Ge=window.showFlyingEmoji)==null||Ge.call(window,{emojiId:I==null?void 0:I.emojiId,senderId:I==null?void 0:I.senderId});break;default:{const T={title:`Payload from timed Metadata ${I}`,duration:It||3e3};console.debug("Added toast ",JSON.stringify(T)),ve.addToast(T);break}}},je=_=>{console.error("[HLSView] error in hls",`${_}`)},ze=({isLive:_})=>{Pe(_)},Ze=_=>{yt(_.state===hn.paused),A(H(L({},b),{pausePlay:!0})),setTimeout(()=>{A(H(L({},b),{pausePlay:!1}))},2e3)},Ne=_=>{vt(_)},We=_=>Ae(!!_);if(o&&O)return i=new Ut(O,o),i.on(v.SEEK_POS_BEHIND_LIVE_EDGE,ze),i.on(v.TIMED_METADATA_LOADED,Ve),i.on(v.ERROR,je),i.on(v.PLAYBACK_STATE,Ze),i.on(v.CAPTION_ENABLED,Ne),i.on(v.AUTOPLAY_BLOCKED,We),i.on(v.MANIFEST_LOADED,m),i.on(v.LAYER_UPDATED,V),()=>{i.off(v.SEEK_POS_BEHIND_LIVE_EDGE,ze),i.off(v.ERROR,je),i.off(v.TIMED_METADATA_LOADED,Ve),i.off(v.PLAYBACK_STATE,Ze),i.off(v.CAPTION_ENABLED,Ne),i.off(v.AUTOPLAY_BLOCKED,We),i.off(v.MANIFEST_LOADED,m),i.off(v.LAYER_UPDATED,V),i.reset()}},[O,he,M]),n.useEffect(()=>{const o=m=>Et(m);return P?i==null||i.on(v.STATS,o):i==null||i.off(v.STATS,o),()=>{i==null||i.off(v.STATS,o)}},[P]);const Oe=()=>F(void 0,null,function*(){try{yield i.play(),Ae(!1)}catch(o){console.error("Tried to unblock Autoplay failed with",o.message)}}),Pt=()=>{M.setAppData(Z.hlsStats,!P)};n.useEffect(()=>(D&&R&&!G&&S.current&&clearTimeout(S.current),!R&&S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{ne||te(!1)},5e3),()=>{S.current&&clearTimeout(S.current)}),[D,R,ne,G]);const de=n.useCallback(o=>{var m;be({isLandscape:g,isMobile:E,seek:o}).with({seek:-10,isMobile:!1,isLandscape:!1},()=>{A(H(L({},b),{seekBackward:!0})),setTimeout(()=>{A(H(L({},b),{seekBackward:!1}))},1e3)}).with({seek:10,isMobile:!1,isLandscape:!1},()=>{A(H(L({},b),{seekForward:!0})),setTimeout(()=>{A(H(L({},b),{seekForward:!1}))},1e3)}).otherwise(()=>null),i==null||i.seekTo(((m=u.current)==null?void 0:m.currentTime)+o)},[b,g,E]),Tt=n.useCallback(o=>{var m;if(!(E||g)||((m=p==null?void 0:p.variants[0])==null?void 0:m.playlist_type)!==B.DVR)return;o.screenX*100/o.target.clientWidth<45?(A(H(L({},b),{seekBackward:!0})),de(-10)):(A(H(L({},b),{seekForward:!0})),de(10)),setTimeout(()=>{A(H(L({},b),{seekForward:!1,seekBackward:!1}))},1e3)},[p==null?void 0:p.variants,b,g,E,de]),Lt=n.useCallback(()=>F(void 0,null,function*(){var o;be({isMobile:E,isLandscape:g,playlist_type:(o=p==null?void 0:p.variants[0])==null?void 0:o.playlist_type}).with({playlist_type:B.DVR,isMobile:!1,isLandscape:!1},()=>F(void 0,null,function*(){U?yield i==null?void 0:i.play():i==null||i.pause()})).when(({isMobile:m,isLandscape:V})=>m||V,()=>{te(m=>!m),S.current&&clearTimeout(S.current)}).otherwise(()=>null)}),[p==null?void 0:p.variants,g,E,U]),ge=n.useCallback(o=>{if(o.preventDefault(),!(E||g)){if(o.type==="mouseenter"||G){te(!0);return}o.type==="mouseleave"&&!ne?te(!1):!D&&o.type==="mousemove"&&(te(!0),S.current&&clearTimeout(S.current))}},[D,g,E,G,ne]),Mt=Gt(U,i);return!O||N?e.createElement(e.Fragment,null,e.createElement(rt,null),$.current&&(E||g)&&e.createElement(j,{css:{position:"fixed",left:"$4",top:"$4",zIndex:11}},e.createElement(Ke,{screenType:"hls_live_streaming",container:$.current})),e.createElement(d,{key:"hls-viewer",id:`hls-viewer-${k}`,ref:$,direction:E||g?"column":"row",justify:"center",css:{flex:g?"2 1 0":"1 1 0"}},N?e.createElement(Qe,{icon:e.createElement(gn,{height:56,width:56}),title:"Stream has ended",subtitle:"Have a nice day!"}):e.createElement(Qe,{icon:e.createElement(Kt,{height:56,width:56,style:{color:"white"}}),title:"Stream yet to start",subtitle:"Sit back and relax"}))):e.createElement(d,{key:"hls-viewer",id:`hls-viewer-${k}`,ref:$,direction:E||g?"column":"row",justify:"center",css:{flex:g?"2 1 0":"1 1 0",transition:"all 0.3s ease-in-out","&:fullscreen":{"& video":{height:"unset !important"}}}},$.current&&(E||g)&&e.createElement(j,{css:{position:"fixed",left:"$4",top:"$4",zIndex:11}},e.createElement(Ke,{screenType:"hls_live_streaming",container:$.current})),e.createElement(pt.Provider,{value:{hlsPlayer:i}},fe!=null&&fe.url&&P&&!(E||g)?e.createElement(_n,{hlsStatsState:fe,onClose:Pt}):null,e.createElement(d,{id:"hls-player-container",align:"center",justify:"center",css:{size:"100%",margin:"0 auto","@md":{height:"auto"},outline:"none"},onKeyDown:o=>F(void 0,null,function*(){var m;((m=p==null?void 0:p.variants[0])==null?void 0:m.playlist_type)===B.DVR&&(yield Mt(o))}),tabIndex:"0"},!(E||g)&&e.createElement(et,{open:ce,unblockAutoPlay:Oe}),Ee&&e.createElement(d,{align:"center",justify:"center",css:{position:"absolute"}},e.createElement(Qt,{width:72,height:72})),e.createElement(C.Root,{ref:u,onMouseEnter:ge,onMouseMove:ge,onMouseLeave:ge,onClick:Lt,onDoubleClick:o=>{Tt(o)}},e.createElement(e.Fragment,null,!(E||g)&&e.createElement(d,{align:"center",justify:"between",css:{position:"absolute",bg:`${b.pausePlay||b.seekBackward||b.seekForward?"#00000066":""}`,display:"inline-flex",gap:"$2",zIndex:1,size:"100%"}},!Ee&&((a=p==null?void 0:p.variants[0])==null?void 0:a.playlist_type)===B.DVR&&e.createElement(C.PlayPauseSeekControls.Overlay,{isPaused:U,showControls:D,hoverControlsVisible:b})),E||g?e.createElement(e.Fragment,null,!Ee&&((l=p==null?void 0:p.variants[0])==null?void 0:l.playlist_type)===B.DVR&&e.createElement(C.PlayPauseSeekControls.Overlay,{isPaused:U,showControls:D,hoverControlsVisible:b}),e.createElement(d,{ref:He,direction:"column",justify:"start",align:"start",css:{position:"absolute",top:"0",left:"0",width:"100%",flexShrink:0,zIndex:1,visibility:D?"":"hidden",opacity:D?"1":"0"}},e.createElement(C.Controls.Root,{css:{p:"$4 $8"},onClick:o=>o.stopPropagation()},e.createElement(C.Controls.Right,null,(g||E&&R)&&St&&e.createElement(Yt,{onClick:()=>{R&&pe(),setTimeout(()=>{kt()},0)}}),Le&&!ce&&e.createElement(tt,{isEnabled:Te}),$.current&&ee.length>0&&!ce?e.createElement(nt,{layers:ee,onOpenChange:Ie,open:G,selection:Me,onQualityChange:Fe,isAuto:Re,containerRef:$.current}):null,e.createElement(et,{open:ce,unblockAutoPlay:Oe}))))):null,D&&e.createElement(d,{ref:He,direction:E?"columnReverse":"column",justify:"end",align:"start",css:{position:"absolute",bottom:R&&((s=p==null?void 0:p.variants[0])==null?void 0:s.playlist_type)===B.DVR?"$8":"0",left:"0",zIndex:1,background:E||g?"":`linear-gradient(180deg, ${Ye.colors.background_dim.value}00 29.46%, ${Ye.colors.background_dim.value}A3 100%);`,width:"100%",pt:"$8",flexShrink:0,transition:"visibility 0s 0.5s, opacity 0.5s linear"}},((r=p==null?void 0:p.variants[0])==null?void 0:r.playlist_type)===B.DVR?e.createElement(C.Progress,{seekProgress:ne,setSeekProgress:Ct}):null,e.createElement(C.Controls.Root,{css:{p:"$4 $8"},onClick:o=>o.stopPropagation()},e.createElement(C.Controls.Left,null,!(E||g)&&e.createElement(e.Fragment,null,((c=p==null?void 0:p.variants[0])==null?void 0:c.playlist_type)===B.DVR?e.createElement(e.Fragment,null,e.createElement(C.PlayPauseSeekControls.Button,{isPaused:U,onSeekTo:de}),W?null:e.createElement(C.Duration,null)):null,e.createElement(C.Volume,null)),e.createElement(J,{css:{px:"$2"},onClick:o=>F(void 0,null,function*(){o.stopPropagation(),yield i==null?void 0:i.seekToLivePosition(),Pe(!0)}),key:"jump-to-live_btn","data-testid":"jump-to-live_btn"},e.createElement(X,{title:W?"Live":"Go to Live",side:"top"},e.createElement(d,{justify:"center",gap:2,align:"center"},e.createElement(j,{css:{height:"$4",width:"$4",background:W?"$alert_error_default":"$on_primary_medium",r:"$1"}}),e.createElement(w,{variant:"$body1",css:{c:W?"$on_surface_high":"$on_surface_medium",fontWeight:"$semiBold"}},W?"LIVE":"GO LIVE")))),(E||g)&&!W&&((f=p==null?void 0:p.variants[0])==null?void 0:f.playlist_type)===B.DVR?e.createElement(C.Duration,null):null),e.createElement(C.Controls.Right,null,Le&&!(E||g)&&e.createElement(tt,{isEnabled:Te}),ee.length>0&&!(E||g)?e.createElement(nt,{layers:ee,onOpenChange:Ie,open:G,selection:Me,onQualityChange:Fe,isAuto:Re}):null,xt?e.createElement(In,{isFullScreen:R,onToggle:pe}):null))))))),e.createElement(rt,{isFullScreen:R}),E&&!R&&e.createElement(Hn,null))},zn=Bn;export{zn as default};
